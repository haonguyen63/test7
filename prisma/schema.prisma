generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String   @id @default(cuid())
  phone       String   @unique
  username    String?  @unique
  name        String
  password    String
  role        Role     @default(STAFF)
  createdAt   DateTime @default(now())
  managedBy   String?  
  orders      Order[]
  createdUsers User[]  @relation("ManagedUsers", references: [id])
  manager     User?    @relation("ManagedUsers", fields: [managedBy], references: [id])
}

model Customer {
  id          String   @id @default(cuid())
  phone       String   @unique
  name        String
  points      Int      @default(0)
  createdAt   DateTime @default(now())
  orders      Order[]
}

model Order {
  id           String   @id @default(cuid())
  customerId   String
  customer     Customer @relation(fields: [customerId], references: [id])
  staffId      String
  staff        User     @relation(fields: [staffId], references: [id])
  totalAmount  Int      
  pointsEarned Int
  pointsUsed   Int
  discount     Int      
  createdAt    DateTime @default(now())
}

enum Role {
  STAFF
  MANAGER
  ADMIN
}